{% extends "base.html" %}

{% block content %}
<ul class="p-2" id="tasks-pane">
    {% for todo in todos %}
    {% block task scoped %}
    <li class="my-1 mx-1" hx-target="this" hx-swap="outerHTML">
        {% if todo.status == 'done' %}
        <i class="fa-regular fa-square-check"></i>
        {% else %}
        <i class="fa-regular fa-square"
           hx-trigger="click"
           hx-put="{{ url_for('update_todo', todo_id=todo.id) }}"
           hx-ext="json-enc"
           hx-vals='{"status":"done"}'
        ></i>
        {% endif %}
        <span hx-target="#detail-view" hx-trigger="click" hx-get="{{url_for('get_todo',todo_id=todo.id)}}"
              hx-swap="innerHTML">
            {{ todo.task }}
        </span>
    </li>
    {% endblock task %}
    {% endfor %}
</ul>
<input class="border rounded w-full py-2 px-3 text-gray-700"
       id="task" type="text"
       name="task"
       placeholder="Add New Task"
       hx-trigger="keyup[key=='Enter']"
       hx-post="{{ url_for('add_todo')}}"
       hx-target="#tasks-pane"
       hx-swap="beforeend"
       hx-ext="json-enc"
>
{% endblock content %}
{% block detail_view %}
{% if todo_focus %}
<div class=" border rounded" hx-target="this" hx-swap="delete">
    <i class="fa-solid fa-xmark" hx-trigger="click"></i>
    <p>{{todo_focus.id}}</p>
    <p>{{todo_focus.task}}</p>
    <p>{{todo_focus.created_at}}</p>
    <p>{{todo_focus.status}}</p>
</div>
{%endif%}
{% endblock detail_view %}
